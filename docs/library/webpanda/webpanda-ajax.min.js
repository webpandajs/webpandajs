/**
 * webpanda.js is JavaScript framework for building project on the web.
 * Copyright (c) 1992-2023, webpandajs.com. (MIT Licensed)
 * email <a@apilipala.com> 
 * qq <1102119280>
 * https://webpandajs.com/
 * https://github.com/webpandajs/webpandajs
 */
!function(o,a,n){"use strict";function i(t){if(null!==t&&"object"==typeof t&&t.constructor===Array)for(var e=new Array,s=0;s<t.length;s++)null!==t[s]&&"object"==typeof t[s]?e.push(i(t[s])):e.push(t[s]);else if(null!==t&&"object"==typeof t&&t.constructor===Object){e=new Object;for(s in t)t.hasOwnProperty(s)&&(null!==t[s]&&"object"==typeof t[s]?e[s]=i(t[s]):e[s]=t[s])}else e=t;return e}function t(t){var e,s;t&&"object"==typeof t||(t=new Object),this.XMLHttpRequest=null,this.method="string"==typeof t.method?t.method.toUpperCase().trim():"GET",this.url="","number"==typeof t.url||"string"==typeof t.url?this.url=n.url("string"==typeof(e=t.url)?e:"number"==typeof e?String(e):""):"object"==typeof t.url&&n.url.isInstanceOf(t.url)?this.url=t.url:this.url=n.url(""),this.user="undefined"!=typeof t.user?t.user:null,this.password="undefined"!=typeof t.password?t.password:null,this["async"]="undefined"==typeof t["async"]||Boolean(t["async"]),this.responseType="string"==typeof t.responseType?t.responseType.toLowerCase().trim():"text",this.body=null,"undefined"!=typeof t.body&&("number"==typeof t.body?this.body=String(t.body):!t.body||"object"!=typeof t.body||t.body.constructor!=Object&&t.body.constructor!=Array?this.body=t.body:this.body=i(t.body)),this.header=null!==(e=t.header)&&"object"==typeof e&&e.constructor==Object?t.header:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.timeout=-1,"undefined"!=typeof t.timeout&&(s=parseInt(t.timeout))&&!isNaN(s)&&(this.timeout=s),this.onready="function"==typeof t.onready?t.onready:null,this.onrequest="function"==typeof t.onrequest?t.onrequest:null,this.onresponse="function"==typeof t.onresponse?t.onresponse:null,this.onsuccess="function"==typeof t.onsuccess?t.onsuccess:null,this.onerror="function"==typeof t.onerror?t.onerror:null}function e(t){this.ajax=t,this.isTimeout=!1,this.timer=null,this.isErrorExecuted=!1,this.createXMLHttpRequest(),this.ajax.XMLHttpRequest&&"undefined"!=typeof this.ajax.XMLHttpRequest.open&&(this.createReadystatechangeEvent(),this.createAbortEvent(),this.createErrorEvent(),this.submit())}n.language({Ajax_ERROR_NONSUPPORT:"当前浏览器不支持Ajax"}),t.prototype={constructor:t,author:"a@apilipala.com",version:"5.0.1",send:function(){return new e(this),this},abort:function(){return this.XMLHttpRequest&&"function"==typeof this.XMLHttpRequest.abort&&this.XMLHttpRequest.abort(),this}},e.prototype={constructor:e,error:function(t,e,s,o){if(this.isErrorExecuted)return!1;this.isErrorExecuted=!0;t=this.createError(t,e,s,o);"function"==typeof this.ajax.onerror&&this.ajax.onerror.call(this.ajax,t)},createError:function(t,e,s,o){o={data:o||null,type:t,status:e,message:s};return void 0===e&&this.ajax.XMLHttpRequest&&(o.status=this.ajax.XMLHttpRequest.status),void 0===s&&this.ajax.XMLHttpRequest&&(o.message=this.ajax.XMLHttpRequest.statusText),o},createResponse:function(t,e){return{data:undefined,status:t,message:e}},createXMLHttpRequest:function(){if(this.ajax.abort(),this.ajax.XMLHttpRequest=null,o.XMLHttpRequest)this.ajax.XMLHttpRequest=new XMLHttpRequest;else if(o.ActiveXObject)for(var t=["Microsoft.XMLHTTP","MSXML2.XMLHTTP"],e=0;e<t.length;e++)try{this.ajax.XMLHttpRequest=new ActiveXObject(t[e]);break}catch(s){this.error("ActiveXObjectError",-1,n.language.target("Ajax_ERROR_NONSUPPORT"))}},createReadystatechangeEvent:function(){var o=this,r=this.ajax;this.ajax.XMLHttpRequest.onreadystatechange=function(){if("function"==typeof r.onready&&r.onready.call(r,r.XMLHttpRequest.readyState),4==r.XMLHttpRequest.readyState){o.timer&&(o.timer.stop(),o.timer=null);var t=o.createResponse(r.XMLHttpRequest.status,r.XMLHttpRequest.statusText),e="string"==typeof r.responseType?r.responseType.toLowerCase().trim():"text";if("xml"===e)t.data=r.XMLHttpRequest.responseXML;else if("json"===e)try{""!==r.XMLHttpRequest.response?t.data=JSON.parse(r.XMLHttpRequest.response):t.data={}}catch(s){t.data={}}else t.data="text"===e?r.XMLHttpRequest.responseText:r.XMLHttpRequest.response;return!o.isTimeout&&(200<=t.status&&t.status<300||304==t.status)?"function"==typeof r.onsuccess&&r.onsuccess.call(r,t):o.isTimeout?(r.XMLHttpRequest.fireEvent?r.XMLHttpRequest.fireEvent("ontimeout"):((e=a.createEvent("HTMLEvents")).initEvent("timeout",!1,!0),r.XMLHttpRequest.dispatchEvent(e)),t.message="The request timeout",o.error("timeout",t.status,t.message,t.data)):n.queue(function(){o.error("error",t.status,t.message,t.data)}),"function"==typeof r.onresponse&&r.onresponse.call(r,t),!0}}},createAbortEvent:function(){var t=this;this.ajax.XMLHttpRequest.onabort=function(){t.error("abort")}},createErrorEvent:function(){var t=this;this.ajax.XMLHttpRequest.onerror=function(){t.error("error")}},setTimeout:function(){var t,e,s=parseInt(this.ajax.timeout);!isNaN(s)&&0<s&&(t=this.ajax,(e=this).timer=n.timer(function(){4!=t.XMLHttpRequest.readyState&&(e.isTimeout=!0,t.XMLHttpRequest.onabort=null,t.XMLHttpRequest.abort(),e.timer)&&(e.timer.stop(),e.timer=null)},!0).timeout(s).start())},submit:function(){var t="object"==typeof this.ajax.url&&n.url.isInstanceOf(this.ajax.url)?this.ajax.url.toString():"",e="string"==typeof this.ajax.method?this.ajax.method.toUpperCase().trim():"GET",s=!!this.ajax["async"];if((this.ajax.XMLHttpRequest.open(e,t,s,this.ajax.user,this.ajax.password),"function"==typeof this.ajax.onrequest)&&!1===this.ajax.onrequest.call(this.ajax,this.ajax.XMLHttpRequest))return this.ajax.XMLHttpRequest.abort(),!1;var o=i(this.ajax.header),e=null;if(this.ajax.body&&"object"==typeof this.ajax.body?"undefined"!=typeof FormData&&this.ajax.body.constructor==FormData?(e=this.ajax.body,"undefined"!=typeof o["Content-Type"]&&delete o["Content-Type"]):e=this.ajax.body.constructor==Object||this.ajax.body.constructor==Array?"undefined"!=typeof o["Content-Type"]&&"application/json"==o["Content-Type"]?JSON.stringify(this.ajax.body):n.URLQueryEncode(this.ajax.body):this.ajax.body:"string"==typeof this.ajax.body?e=this.ajax.body:"number"==typeof this.ajax.body&&(e=String(this.ajax.body)),o&&"object"==typeof o)for(var r in o)this.ajax.XMLHttpRequest.setRequestHeader(r,o[r]);this.setTimeout(),this.ajax.XMLHttpRequest.send(e)}},n.mount.Ajax=t}(window,document,webpanda);