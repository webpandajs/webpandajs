/**
 * webpanda.js is JavaScript framework for building project on the web.
 * Copyright (c) 1992-2023, webpandajs.com. (MIT Licensed)
 * email <a@apilipala.com> 
 * qq <1102119280>
 * https://webpandajs.com/
 * https://github.com/webpandajs/webpandajs
 */
webpanda.data({"abstract":!0,name:"server://base",mount:[webpanda.env.require("component://animation/loading",{use:"Loading"})],prototype:function(){var n=webpanda.data["this"];this.url="",this.method="GET",this["async"]=!0,this.responseType="json",this.body={},this.header={"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.timeout=3e4,this.withCredentials=!0,this.ajax=function(a){(a=a&&"object"==typeof a?a:new Object).isLoading&&n.Loading.open();var e={};for(o in n.body)e[o]=n.body[o];if(a.body&&"object"==typeof a.body)for(var o in a.body)e[o]=a.body[o];return a.isFormData&&(e=n.toFormData(e)),new webpanda.mount.Ajax({url:n.url,body:e,header:n.header,method:n.method,"async":n["async"],responseType:n.responseType,timeout:n.timeout,onrequest:function(e){n.withCredentials&&(e.withCredentials=!0),"function"==typeof a.onprogress&&e.upload&&(e.upload.onprogress=function(e){var o,n,t;e.lengthComputable&&(o=e.loaded,n=e.total,t=Math.floor(100*o/n),a.onprogress(t,o,n))}),"function"==typeof a.onrequest&&a.onrequest.call(this,e)},onresponse:function(e){a.isLoading&&n.Loading.close(),"function"==typeof a.onresponse&&a.onresponse.call(this,e)},onerror:function(e){e.onerror=!0,"function"==typeof a.onerror&&a.onerror.call(this,e),"function"==typeof a.onfinally&&a.onfinally.call(this,e)},onsuccess:function(e){e.onsuccess=!0,"function"==typeof a.onsuccess&&a.onsuccess.call(this,e),"function"==typeof a.onfinally&&a.onfinally.call(this,e)}}).send()},this.toKeyValue=function(e){var o=new Array;if("object"==typeof e)for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==e){var t,a=this.getChildFormData(e[n]);for(t in a)o.push({key:n+a[t].key,value:a[t].value})}return o},this.getChildFormData=function(e){var o=new Array;if(e&&"object"==typeof e){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==e){var t,a=this.getChildFormData(e[n]);for(t in a)o.push({key:"["+n+"]"+a[t].key,value:a[t].value})}}else o.push({key:"",value:e});return o},this.toFormData=function(e){var o=new FormData,n=this.toKeyValue(e);if(n&&n.length)for(var t=0;t<n.length;t++)o.append(n[t].key,n[t].value);return o}}});